---
name: billing-rules
description: This skill should be used when the user asks about billing models, T&M versus milestone billing, payment terms, rate discrepancies, billing best practices, or needs to understand how Smart Data handles client billing.
---

# Billing Rules & Best Practices

## Billing Models

### Time & Materials (T&M)

**When to use:** Projects with evolving scope, discovery phases, ongoing maintenance, or when the client prefers to pay for actual effort.

**How it works:**

- Invoice based on actual hours logged in Harvest multiplied by the agreed bill rate per role
- Bill rates come from sd-estimates' rate schedule (`get_bill_rates`)
- Invoicing frequency: typically bi-weekly or monthly
- Only billable time entries are included (Harvest `billable: true`)

**Rate application rules:**

1. Each team member's bill rate is determined by their role in the estimate
2. If a team member's role isn't in the estimate, use the closest matching role from the rate schedule
3. If a team member performed work outside their primary role (e.g., a developer doing QA), bill at their primary role rate unless the SOW specifies otherwise
4. Never bill above the rate in the signed SOW/estimate without a change order

### Milestone-Based

**When to use:** Fixed-price engagements with well-defined deliverables, or when the SOW specifies milestone payments.

**How it works:**

- Invoice a fixed amount upon completion (and ideally acceptance) of each milestone
- Milestone amounts and criteria come from the SOW (generated by sd-sow from sd-estimates tiers)
- Hours logged are shown as supporting detail but do not affect the invoiced amount

**Payment schedule by estimate tier:**

| Tier      | Typical Split                     | Milestones |
| --------- | --------------------------------- | ---------- |
| Essential | 50% at kickoff, 50% at completion | 2          |
| Standard  | 25% per milestone                 | 4          |
| Premium   | 20% per milestone                 | 5          |

**Milestone invoicing rules:**

1. Only invoice a milestone after deliverables are complete
2. If the client has a formal acceptance process, note acceptance status on the invoice
3. If a milestone is partially complete, do not invoice — wait until complete or negotiate a partial payment with the client
4. Supporting hours detail is informational only — never adjust a milestone payment based on actual hours

## Discrepancy Detection

### Rate Mismatches

**Check:** Compare the bill rate for each team member (from the estimate) against the rate schedule.

- **Minor mismatch (<5%):** Note it but don't block — rates may have been adjusted for the deal
- **Major mismatch (>5%):** Flag and ask the user to confirm the correct rate before generating the invoice
- **No rate found:** Team member's role doesn't exist in the rate schedule — ask the user which rate to apply

### Unbillable Time

**Check:** Identify time entries marked as non-billable in Harvest.

- Common legitimate reasons: internal meetings, training, PTO, non-project overhead
- Flag entries where >20% of a team member's logged hours are non-billable — may indicate a tracking issue
- Non-billable time should never appear on a client invoice

### Suspicious Patterns

**Check for:**

- **Flat 8-hour days for an entire week:** May be placeholder entries, not actual time. Flag for review.
- **Time logged on weekends:** May be legitimate (deadline crunch) or entry errors. Flag for review.
- **Time logged after the billing period:** Late entries. Ask if they should be included in this invoice or the next one.
- **Duplicate entries:** Same person, same day, same task, same hours. Flag as potential duplicate.
- **Zero-note entries:** Time entries with no description. Flag — they'll make the invoice less useful to the client.

### Missing Time

**Check:** For each team member in the estimate, verify they have time entries for each weekday in the billing period.

- Missing days may mean: forgot to log time, was on PTO, or was reassigned
- Don't block invoice generation for missing time — just report it
- Suggest following up with the team member before finalizing

## Payment Terms

### Standard Terms

| Term   | Description                      | Default |
| ------ | -------------------------------- | ------- |
| Net 15 | Payment due 15 days from invoice | No      |
| Net 30 | Payment due 30 days from invoice | Yes     |
| Net 45 | Payment due 45 days from invoice | No      |
| Net 60 | Payment due 60 days from invoice | No      |

- Default to Net 30 unless the SOW or client agreement specifies otherwise
- Due date = invoice issue date + payment term days

### Late Payment

- This plugin does not manage collections or late payment follow-up
- If asked about late payments, note that the SOW should contain late payment terms (typically 1.5% monthly interest)
- Suggest the user consult sd-contracts for late payment clause review

## Invoice Numbering

- Sequential numbering: INV-0001, INV-0002, etc.
- Numbers are global (not per-client or per-project) to ensure uniqueness
- Sequence is tracked in `~/.sd-invoice/sequence.txt`
- If the sequence file is missing or corrupted, scan existing invoice files to determine the highest number and continue from there
- Never reuse an invoice number, even if the original invoice was voided

## Credit Notes

If an invoice needs to be corrected after being sent:

- Do not modify the original invoice file
- Generate a credit note with the next invoice number, referencing the original
- The credit note should show the adjustment amount (negative)
- Then generate a new corrected invoice with the next number after the credit note
